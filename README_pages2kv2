Notes for using the Pages2kv2 dataset.
   Michael Erb, 2/13/2017
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
Running the LMR with Pages2kv2
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

PAGES2kv2 is the current release of the PAGES2k dataset.  To use this dataset in the LMR,
do the following steps.

1) Retrieve the PAGES2kv2 dataset.  Contact Michael Erb (erbm@usc.edu) if you don't
   already have this.  Put this file in the same directory as your NCDC proxy data file.

2) In the files LMR_proxy_preprocess.py, LMR_PSMbuild.py, and LMR_config.py, make sure
   the input and output directories point to the appropriate places on your machine.
   You can find the lines you want to change by searching for "erbm" (my username).

3) In LMR_proxy_preprocess.py, make sure that "proxy_data_source" is set to "PAGES2Kv2".
   Then run this file with "python LMR_proxy_preprocess.py".  This creates proxy and
   metadata files named in the same convention as the NCDC files, but with "Pages2kv2"
   in the name.

4) In LMR_PSMbuild.py and LMR_config.py, make sure that "use_from" is set to "NCDC" and
   "dbversion" is set to "Pages2kv2".  The preprocessed Pages2v2 datasets have been
   designed to work with the "NCDC" code.

5) The code is currently set up to use ALL data records except boreholes and hybrid records,
   which is more types than our typical LMR experiments.  If you want to exclude things
   like "temperature" records or speleothems, comment the appropriate lines in the
   "proxy_order" variable in LMR_config.py.  See the notes section of this document to see
   how many of each proxy type are in the pages2kv2 dataset.

5) Follow the steps in README_v2 to run "LMR_PSMbuild.py", "build_ye_file.py", and
   "LMR_wrapper.py" to run your desired experiment.

-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
Notes for using calendar vs tropical year
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-

The LMR code can use either a calendar year (Jan-Dec) or a tropical year (Apr-Mar).
Before running any code, set the following parameters to make sure that you're using the
calendar that you want.

File                      Parameter             Value for calendar year        Value for tropical year
----                      ---------             -----------------------        -----------------------
LMR_proxy_preprocess.py   year_type             "calendar year"                "tropical year"
LMR_PSMbuild.py           all instances of...   [1,2,3,4,5,6,7,8,9,10,11,12]   [4,5,6,7,8,9,10,11,12,13,14,15]
misc/build_ye_file.py     ""                    ""                             ""
LMR_psms.py               ""                    ""                             ""
LMR_config.py             avgInterval           None                           [4,5,6,7,8,9,10,11,12,13,14,15]


-=-=-=-
Notes
-=-=-=-

 - The LMR_proxy_preprocess.py script could be improved.  In particular, it currently
   computes annual averages of the proxy records using the calendar year (Jan-Dec).  We may
   want to choose a different end date for the year (e.g. April - March).

 - The proxy types and units in the processesed PAGES2kv2 dataset are as follows:

 Corals and Sclerosponges -                   Sr_Ca :  28
 Corals and Sclerosponges -           calcification :   2
 Corals and Sclerosponges -               composite :   6
 Corals and Sclerosponges -                    d18O :  67
 Corals and Sclerosponges -             temperature :   1
                Ice Cores -                    d18O :  39
                Ice Cores -                      dD :   8
                Ice Cores -                    melt :   2
               Lake Cores -             RABD660_670 :   1
               Lake Cores - X_radiograph_dark_layer :   1
               Lake Cores -                massacum :   1
               Lake Cores -             temperature :  34
               Lake Cores -               thickness :   6
             Marine Cores -                    d18O :   1
             Marine Cores -             temperature :  57
              Speleothems -                    d18O :   4
               Tree Rings -                     MXD :  54
               Tree Rings -                 density :   5
               Tree Rings -             temperature :   7
               Tree Rings -                   trsgi : 348
                  bivalve -                    d18O :   1
                 borehole -             temperature :   3
                documents -             temperature :  15
                   hybrid -             temperature :   1

 - In the analysis/ directory, the file "summarize_pages2kv2.py" can be run to produce the
   list above and make figures of every proxy record.

